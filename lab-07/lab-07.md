[TOC]

<div style="page-break-after: always;"></div>

## Цель работы

Освоить на практике применение режима однократного гаммирования.

## Ход работы

Нужно подобрать ключ, чтобы получить сообщение «С Новым Годом, друзья!». Разработаем приложение, позволяющее шифровать и дешифровать данные в режиме однократного гаммирования. 

## Выполнение лабораторной работы

Импортировали необходимые модули, сохранили пользовательский ввод.

```
import random
import string

inpt = input("Введите строку: ")
```

Написали функцию генерации случайного ключа, заданного размера. Написали функцию, преобразующую исходный символьный формат в шестнадцатеричный.

```
def key_gener(size = 6, chars = string.ascii_letters + string.digits):
    return ''.join(random.choice(chars) for _ in range(size))
def chan(s):
    return ":".join ("{:02x}".format(ord(c)) for c in s)
```

Сгенерировали случайный ключ, распечатали его.

```
key = key_gener(len(inpt))
print(f'Ключ в виде строки: {key}')
```

Создали функцию гаммирования.

```
def gam(inpt, key):
    inpt_ascii = [ord(i) for i in inpt]
    key_ascii = [ord(i) for i in key]
    enc_str = ''.join(chr(s ^ k) for s, k, in zip(inpt_ascii, key_ascii))
    return enc_str
```

Создали функцию поиска истинного ключа, который однозначно формируется из исходного и шифрованного текста.

```
def find_truekey(inpt, enc_str):
    sm_ascii = [ord(i) for i in inpt]
    enc_str_ascii = [ord(i) for i in enc_str]
    true_key = ''.join(chr(s ^ k) for s, k in zip(enc_str_ascii, sm_ascii))
    return true_key
```

Сформировали функцию, которая расшифровывает текст с помощью данного ей ключа.

```
def unencrypt(enc_str, key):
    enc_str_ascii = [ord(i) for i in enc_str]
    key_ascii = [ord(i) for i  in key]
    true_str = ''.join(chr(s ^ k) for s, k in zip(enc_str_ascii, key_ascii))
    return true_str
```

Зашифровали пользовательскую строку, используя заранее сгенерированный случайный ключ к данной строке.

```
enc_str = gam(inpt, key)
```

Попытались сформировать ключ для шифрованной строки и расшифровать ее с помощью данного ключа, получили некую последовательность символов.

Выполнили попытку расшифровки строки с помощью истинного ключа, получили исходную строку.

```
new_key = key_gener(len(enc_str))
unencrypted_new_key = unencrypt(enc_str, new_key)
true_key = find_truekey(inpt, enc_str)
unencrypted_true_key = unencrypt(enc_str, true_key)
```

```
print(f'Закодированная строка: {enc_str}')
print(f'В шестнадцатиричной системе: {chan(enc_str)}')
Закодированная строка: їFФѐѹмьGѩѤѽѤюjsѲАЪѽЩЭL
В шестнадцатиричной системе: 457:46:424:450:479:43c:44c:47:469:464:47d:464:44e:6a:73:472:410:42a:47d:429:42d:4c
```

```
print(f'Подобранный ключ: {new_key}')
print(f'Строка, расшифрованная подобранным ключем: {unencrypted_new_key}')
print(f'Настоящий ключ: {true_key}')
print(f'Декодированная строка: {unencrypted_true_key}')
Подобранный ключ: o5GWu1sgSXBLQsCq9xWzmr
Строка, расшифрованная подобранным ключем: иsѣЇЌЍп кмпШП0ЃЩђЪѓр>
Настоящий ключ: vf9nKwpgzZIZrFSFPiJebm
Декодированная строка: С Новым Годом, друзья!
```



## Вывод

В ходе выполнения лабораторной работы была изучена теория режима однократного гаммирования и освоена на практике.

<div style="page-break-after: always;"></div>

## Ответы на контрольные вопросы

1. Поясните смысл однократного гаммирования.

Гаммирование – это наложение (снятие) на открытые (зашифрованные) данные криптографической гаммы, то есть последовательности элементов данных, вырабатываемых с помощью некоторого криптографического алгоритма, для получения зашифрованных (открытых) данных.

Однократное гаммирование – это когда каждый символ попарно с символом ключа складываются по модулю 2 (XOR) (обозначается знаком Å).

2. Перечислите недостатки однократного гаммирования.

Недостатки: Размер ключевого материала должен совпадать с размером передаваемых сообщений. Также необходимо иметь эффективные процедуры для выработки случайных равновероятных двоичных последовательностей и специальную службу для развоза огромного количества ключей. А ещё, если одну и ту же гамму использовать дважды для разных сообщений, то шифр из совершенно стойкого превращается в «совершенно нестойкий» и допускает дешифрование практически вручную.

3. Перечислите преимущества однократного гаммирования.

Достоинства: С точки зрения теории криптоанализа метод шифрования случайной однократной равновероятной гаммой той же длины, что и открытый текст, является невскрываемым. Кроме того, даже раскрыв часть сообщения, дешифровщик не сможет хоть сколько-нибудь поправить положение - информация о вскрытом участке гаммы не дает информации об остальных ее частях. К достоинствам также можно отнести простоту реализации и удобство применения.

4. Почему длина открытого текста должна совпадать с длиной ключа?

Потому что каждый символ открытого текста должен складываться с символом ключа попарно.

5. Какая операция используется в режиме однократного гаммирования, назовите её особенности?

В режиме однократного гаммирования используется сложение по модулю 2 (XOR) между элементами гаммы и элементами подлежащего сокрытию текста. Особенность заключается в том, что этот алгоритм шифрования является симметричным. Поскольку двойное прибавление одной и той же величины по модулю 2 восстанавливает исходное значение, шифрование и расшифрование выполняется одной и той же программой.

6. Как по открытому тексту и ключу получить шифротекст?

Если известны ключ и открытый текст, то задача нахождения шифротекста заключается в применении к каждому символу открытого текста следующего правила:

![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image002.png) = ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image004.png) ⊕ ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image006.png),

где ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image002.png) — i-й символ получившегося зашифрованного послания, ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image004.png) — i-й символ открытого текста, ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image006.png) — i-й символ ключа, i = 1, m. Размерности открытого текста и ключа должны совпадать, и полученный шифротекст будет такой же длины.

7. Как по открытому тексту и шифротексту получить ключ?

Если известны шифротекст и открытый текст, то задача нахождения ключа решается также в соответствии с, а именно, обе части равенства необходимо сложить по модулю 2 с ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image004.png):

![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image002.png) ⊕ ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image004.png) = ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image004.png) ⊕ ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image006.png) ⊕ ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image004.png) = ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image006.png),

![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image006.png) = ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image002.png) ⊕ ![img](file:///C:/Users/Admin-PC/AppData/Local/Packages/oice_16_974fa576_32c1d314_6c4/AC/Temp/msohtmlclip1/01/clip_image004.png).

8. В чем заключаются необходимые и достаточные условия абсолютной стойкости шифра?

Необходимые и достаточные условия абсолютной стойкости шифра:

·    Полная случайность ключа;

·    Равенство длин ключа и открытого текста;

·    Однократное использование ключа.
